(function(c){c.fn.formset=function(d){var a=c.extend({},c.fn.formset.defaults,d),l=a.extraClasses.join(" "),d=c(this),h=function(e,f){a.extraClasses&&(e.removeClass(l),e.addClass(a.extraClasses[f%a.extraClasses.length]))},i=function(a,f,c){var b=RegExp("("+f+"-\\d+-)|(^)"),f=f+"-"+c+"-";a.attr("for")&&a.attr("for",a.attr("for").replace(b,f));a.attr("id")&&a.attr("id",a.attr("id").replace(b,f));a.attr("name")&&a.attr("name",a.attr("name").replace(b,f));a.attr("data-return_id")&&a.attr("data-return_id",
a.attr("data-return_id").replace(b,f));a.attr("data-return_value")&&a.attr("data-return_value",a.attr("data-return_value").replace(b,f))},k=function(e){e.is("TR")?e.children(":last").append('<a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a>"):e.is("UL")||e.is("OL")?e.append('<li><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></li>"):e.append('<a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a>");e.find("a."+a.deleteCssClass).click(function(){var f=
c(this).parents("."+a.formCssClass),e=f.find('input:hidden[id $= "-DELETE"]');if(e.length)e.val("on"),f.hide();else{f.remove();e=c("."+a.formCssClass).not(".formset-custom-template");c("#id_"+a.prefix+"-TOTAL_FORMS").val(e.length);for(var b=0,d=e.length;b<d;b++)h(e.eq(b),b),e.eq(b).find("input,select,textarea,label,span").each(function(){i(c(this),a.prefix,b)})}a.removed&&a.removed(f);return!1})};d.each(function(e){var b=c(this),d=b.find('input:checkbox[id $= "-DELETE"]');d.length&&(d.before('<input type="hidden" name="'+
d.attr("name")+'" id="'+d.attr("id")+'" />'),d.remove());0<b.find("input,select,textarea,label").length&&(k(b),b.addClass(a.formCssClass),h(b,e))});if(d.length){var b;a.formTemplate?(b=a.formTemplate instanceof c?a.formTemplate:c(a.formTemplate),b.removeAttr("id").addClass(a.formCssClass).addClass("formset-custom-template"),b.find("input,select,textarea,label,span").each(function(){i(c(this),a.prefix,2012)}),k(b)):(b=c("."+a.formCssClass+":last").clone(!0).removeAttr("id"),b.find('input:hidden[id $= "-DELETE"]').remove(),
b.find("input,select,textarea,label").each(function(){var a=c(this);a.is("input:checkbox")||a.is("input:radio")?a.attr("checked",!1):a.val("")}));a.formTemplate=b;if("TR"==d.attr("tagName")){b=d.eq(0).children().length;var g="",j=parseInt(c("#id_form-TOTAL_FORMS").val());j>=a.maxList&&(g=' style="display:none;"');d.parent().append('<tr><td colspan="'+b+'"><a class="'+a.addCssClass+'" href="javascript:void(0)"'+g+">"+a.addText+"</a></tr>");b=d.parent().find("tr:last a");b.parents("tr").addClass(a.formCssClass+
"-add")}else g="",j=parseInt(c("#id_form-TOTAL_FORMS").val()),j>=a.maxList&&(g=' style="display:none;"'),d.filter(":last").after('<a class="'+a.addCssClass+'" href="javascript:void(0)"'+g+">"+a.addText+"</a>"),b=d.filter(":last").next();b.click(function(){var b=parseInt(c("#id_"+a.prefix+"-TOTAL_FORMS").val()),f=a.formTemplate.clone(true).removeClass("formset-custom-template"),d=c(this).parents("tr."+a.formCssClass+"-add").get(0)||this;h(f,b);f.insertBefore(c(d)).show();f.find("input,select,textarea,label,span").each(function(){i(c(this),
a.prefix,b)});c("#id_"+a.prefix+"-TOTAL_FORMS").val(b+1);a.added&&a.added(f);return false})}return d};c.fn.formset.defaults={prefix:"form",formTemplate:null,addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",formCssClass:"dynamic-form",extraClasses:[],added:null,removed:null}})(jQuery);
